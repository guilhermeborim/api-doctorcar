generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id             String    @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  email          String    @unique
  password       String
  profilePicture String?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  vehicle        Vehicle[]
}

model Vehicle {
  id               String        @id @default(auto()) @map("_id") @db.ObjectId
  brandId          String        @db.ObjectId
  brand            Brand         @relation(fields: [brandId], references: [id])
  model            String
  licensePlate     String        @unique
  year             Int
  ownerId          String        @db.ObjectId
  owner            User          @relation(fields: [ownerId], references: [id])
  kilometersDriven Int
  dailyMileage     Int
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
  maintenances     Maintenance[]
  stateVehicleId   String        @db.ObjectId
  stateVehicle     vehicleState  @relation(fields: [stateVehicleId], references: [id])

  @@index([brandId, model])
}

model MaintenanceType {
  id           String        @id @default(auto()) @map("_id") @db.ObjectId
  name         String        @unique
  benefits     String[]
  icon         String
  maintenances Maintenance[]
}

model Maintenance {
  id                    String          @id @default(auto()) @map("_id") @db.ObjectId
  vehicleId             String          @db.ObjectId
  vehicle               Vehicle         @relation(fields: [vehicleId], references: [id])
  maintenanceTypeId     String          @db.ObjectId
  maintenanceType       MaintenanceType @relation(fields: [maintenanceTypeId], references: [id])
  kilometersAtService   Int
  kilometersNextService Int
  dateOfService         DateTime
  serviceCoast          Float
  createdAt             DateTime        @default(now())
  updatedAt             DateTime        @updatedAt
}

model Brand {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  name        String    @unique
  description String
  logo        String
  vehicles    Vehicle[]
}

model vehicleState {
  id       String    @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  vehicles Vehicle[]
}
